<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitHub RSS Feeds Test</title>
    <style>
        body { font-family: sans-serif; max-width: 1000px; margin: 50px auto; padding: 20px; }
        .card { border: 1px solid #ccc; border-radius: 8px; padding: 20px; margin: 20px 0; }
        .loading { color: #666; }
        .error { color: red; }
        .success { color: green; }
        .discussion { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 4px; }
        .discussion h4 { margin: 0 0 10px 0; }
        .meta { color: #666; font-size: 0.9em; }
    </style>
</head>
<body>
    <h1>GitHub RSS/Atom Feeds Test</h1>
    
    <div class="card">
        <h2>Discussions Feed</h2>
        <div id="discussions" class="loading">Loading...</div>
    </div>
    
    <div class="card">
        <h2>Releases Feed</h2>
        <div id="releases" class="loading">Loading...</div>
    </div>

    <script>
        async function fetchDiscussions() {
            try {
                const response = await fetch('https://github.com/orgs/Far-Beyond-Pulsar/discussions.atom');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const xmlText = await response.text();
                const parser = new DOMParser();
                const xml = parser.parseFromString(xmlText, 'text/xml');
                
                const entries = Array.from(xml.querySelectorAll('entry')).slice(0, 4);
                
                let html = '<p class="success">✓ Successfully fetched ' + entries.length + ' discussions</p>';
                
                entries.forEach(entry => {
                    const title = entry.querySelector('title')?.textContent || '';
                    const link = entry.querySelector('link[rel="alternate"]')?.getAttribute('href') || '';
                    const author = entry.querySelector('author name')?.textContent || 'Unknown';
                    const updated = entry.querySelector('updated')?.textContent || '';
                    const content = entry.querySelector('content')?.textContent || '';
                    
                    html += `
                        <div class="discussion">
                            <h4><a href="${link}" target="_blank">${title}</a></h4>
                            <p>${content.substring(0, 200)}...</p>
                            <div class="meta">
                                By ${author} • Updated ${new Date(updated).toLocaleDateString()}
                            </div>
                        </div>
                    `;
                });
                
                document.getElementById('discussions').innerHTML = html;
            } catch (error) {
                document.getElementById('discussions').innerHTML = `
                    <p class="error">✗ Error: ${error.message}</p>
                `;
            }
        }

        async function fetchReleases() {
            try {
                const response = await fetch('https://github.com/Far-Beyond-Pulsar/Pulsar-Native/releases.atom');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const xmlText = await response.text();
                const parser = new DOMParser();
                const xml = parser.parseFromString(xmlText, 'text/xml');
                
                const entries = Array.from(xml.querySelectorAll('entry')).slice(0, 3);
                
                let html = '<p class="success">✓ Successfully fetched ' + entries.length + ' releases</p>';
                
                entries.forEach(entry => {
                    const title = entry.querySelector('title')?.textContent || '';
                    const link = entry.querySelector('link[rel="alternate"]')?.getAttribute('href') || '';
                    const updated = entry.querySelector('updated')?.textContent || '';
                    const author = entry.querySelector('author name')?.textContent || 'Unknown';
                    
                    html += `
                        <div class="discussion">
                            <h4><a href="${link}" target="_blank">${title}</a></h4>
                            <div class="meta">
                                By ${author} • Published ${new Date(updated).toLocaleDateString()}
                            </div>
                        </div>
                    `;
                });
                
                document.getElementById('releases').innerHTML = html;
            } catch (error) {
                document.getElementById('releases').innerHTML = `
                    <p class="error">✗ Error: ${error.message}</p>
                `;
            }
        }

        // Run tests
        fetchDiscussions();
        fetchReleases();
    </script>
</body>
</html>
